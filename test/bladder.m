clear all;
close all;
clc;

addpath('../');
addpath('../external/');

rand('state', 1);
randn('state', 1);

options.hgtables = '../config/hgTables_b37.txt'; % human genome annotation table
options.gcdir = '/data/cyau/software/gc/b37/'; % directory of local GC content files
options.outdir = '/data/cyau/wgs500/output/'; % output directory
options.tumourStateTable = '../config/tumourStates.txt';
batchfile = '/data/cyau/wgs500/bladder.csv';

[samplename, infile, normalfile ] = textread(batchfile, '%s %s %s', 'headerlines', 1);
nfiles = length(samplename);

for fi = 1 : nfiles

	options.samplename = samplename{fi}; % sample name
	options.infile = [ infile{fi} '.gz' ]; % input data file
	options.normalfile = [ normalfile{fi} '.gz' ]; % input data file

	disp(samplename{fi});

	tic
	oncoseq( 	'--read_depth_range', '[10:60]', ...
				'--chr_range', '[1:22]', ...
				'--n_train', '30000', ...
				'--maxploidy', '4.5', ...
				'--minploidy', '1.5', ...
				'--seqerror', '0.01', ...
				'--readerror', '0.01', ...
				'--normalcontamination', ...
				'--training', ...
				'--maxnormalcontamination', '0.9', ...
				'--hgtable', options.hgtables, ...
				'--gcdir', options.gcdir, ...
				'--seqtype', 'illumina', ...
				'--samplename', options.samplename, ...
				'--infile', options.infile, ...
				'--normalfile', options.normalfile, ...
				'--outdir', options.outdir ...
			);
	toc

end
